# Bug Fix: Withdrawal History TxID Link Opens Invalid Page

## Issue Summary

When users click on the TxID link in the Withdrawal History page, the browser shows "This site can't be reached" (`DNS_PROBE_FINISHED_NXDOMAIN`) because the URL is malformed.

**Actual URL**: `https://explorer.solana.com3zpqjcec52nfj1jyrncvhexgyn4nxxmrtzg6mj4hdc4hsjjhgpho6bnmixmed4hka6rqjn2ahpk7e3yfl89atnsu`

**Expected URL**: `https://explorer.solana.com/tx/3zpqjcec52nfj1jyrncvhexgyn4nxxmrtzg6mj4hdc4hsjjhgpho6bnmixmed4hka6rqjn2ahpk7e3yfl89atnsu`

---

## Root Cause

The Solana blockchain explorer URL is missing the `/tx/` path segment in the configuration.

### Source of the Bug

**File**: `broker/admin-common/core/src/main/java/io/bhex/bhop/common/constant/AdminTokenTypeEnum.java`
**Line**: 19

```java
SOLANA(14, false, 10, 100, 9, "https://explorer.solana.com/", "0", "SOL"),
```

The URL `https://explorer.solana.com/` is missing `/tx/` compared to other chains.

### URL Concatenation Logic

**File**: `bluehelix/bh-shard/shard-server/src/main/java/io/bhex/bh/service/impl/WithdrawCommonService.java`
**Line**: 627

```java
txExploreUrl = chainTokenSetting.getBlockExploreUrl() + order.getTxId();
```

This concatenation produces invalid URLs when the base URL doesn't include the full path.

---

## Comparison with Other Chains

| Chain  | Explorer URL                              | Status       |
|--------|-------------------------------------------|--------------|
| ETH    | `https://etherscan.io/tx/`                | ✅ Correct   |
| TRX    | `https://tronscan.org/#/transaction/`     | ✅ Correct   |
| HECO   | `https://hecoinfo.com/tx/`                | ✅ Correct   |
| BSC    | `https://bscscan.com/tx/`                 | ✅ Correct   |
| CHZ    | `https://explorer.chiliz.com/tx/`         | ✅ Correct   |
| SOLANA | `https://explorer.solana.com/`            | ❌ Missing `/tx/` |

---

## Files Affected

| File | Line | Description |
|------|------|-------------|
| `broker/admin-common/core/src/main/java/io/bhex/bhop/common/constant/AdminTokenTypeEnum.java` | 19 | Default SOLANA explorer URL definition |
| `bluehelix/bh-shard/shard-server/src/main/java/io/bhex/bh/service/impl/WithdrawCommonService.java` | 627 | Withdrawal TxID URL construction |
| `bluehelix/bh-shard/shard-server/src/main/java/io/bhex/bh/service/impl/DepositNotifyServiceImpl.java` | 500 | Deposit TxID URL construction (same pattern) |
| Database: `TokenSetting` / `tb_base_config` | - | Runtime configuration storage |

---

## Fix Implementation

### Step 1: Update AdminTokenTypeEnum.java (Line 19)

**Before**:
```java
SOLANA(14, false, 10, 100, 9, "https://explorer.solana.com/", "0", "SOL"),
```

**After**:
```java
SOLANA(14, false, 10, 100, 9, "https://explorer.solana.com/tx/", "0", "SOL"),
```

### Step 2: Update Database Records

Run the following SQL to update existing records:

```sql
-- Update token_setting table
UPDATE token_setting
SET block_explore_url = 'https://explorer.solana.com/tx/'
WHERE block_explore_url = 'https://explorer.solana.com/'
   OR block_explore_url = 'https://explorer.solana.com';

-- Update tb_base_config table (if applicable)
UPDATE tb_base_config
SET conf_value = REPLACE(conf_value, '"exploreUrl":"https://explorer.solana.com/"', '"exploreUrl":"https://explorer.solana.com/tx/"')
WHERE conf_group = 'token.chain.type'
  AND conf_key = 'SOLANA';
```

### Step 3: Verify Fix

After deployment, verify by:
1. Navigate to Withdrawal History page
2. Find a Solana withdrawal with a TxID
3. Click on the TxID link
4. Confirm it opens `https://explorer.solana.com/tx/{txid}` correctly

---

## Testing Checklist

- [ ] Update `AdminTokenTypeEnum.java` line 19
- [ ] Run database migration script
- [ ] Deploy updated code
- [ ] Verify Solana withdrawal TxID links work correctly
- [ ] Verify Solana deposit TxID links work correctly
- [ ] Verify other chain TxID links are not affected

---

## Additional Notes

- The same URL concatenation pattern is used in `DepositNotifyServiceImpl.java:500`, so fixing the base URL will resolve both withdrawal and deposit TxID links.
- Consider adding URL validation logic in the future to catch misconfigured explorer URLs.
